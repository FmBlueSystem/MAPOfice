# Prompt 01.4: Database Setup

## Context
- Project structure created
- SQLAlchemy installed

## Execute

### Step 1: Create database models
```python
# Create src/models/base.py
cat > src/models/base.py << 'EOF'
from sqlalchemy import create_engine
from sqlalchemy.ext.declarative import declarative_base
from sqlalchemy.orm import sessionmaker

Base = declarative_base()
engine = create_engine('sqlite:///data/map4.db')
Session = sessionmaker(bind=engine)
EOF
```

### Step 2: Create Track model
```python
# Create src/models/track.py
cat > src/models/track.py << 'EOF'
from sqlalchemy import Column, Integer, String, Float, JSON
from .base import Base

class Track(Base):
    __tablename__ = 'tracks'
    
    id = Column(Integer, primary_key=True)
    file_path = Column(String, unique=True)
    title = Column(String)
    artist = Column(String)
    bpm = Column(Float)
    key = Column(String)
    energy = Column(Float)
    hamms_vector = Column(JSON)
    
    def __repr__(self):
        return f"<Track {self.title}>"
EOF
```

### Step 3: Initialize database
```python
# Create init_db.py
cat > init_db.py << 'EOF'
from src.models.base import Base, engine
from src.models.track import Track

Base.metadata.create_all(engine)
print("✓ Database initialized")
EOF

python init_db.py
```

### Step 4: Verify
```bash
# Check database file
ls -la data/map4.db
# Should exist

# Test connection
python -c "from src.models.base import Session; s=Session(); print('✓ DB connected')"
```

## Checkpoint
```json
{
  "prompt": "01.4-database",
  "success": true,
  "outputs": {
    "database": "data/map4.db",
    "models": ["Track"]
  }
}
```

## Next
→ Continue to `01.5-validation.md`

---
*Tokens: ~2000 | Time: 5 min | Checkpoint: Required*